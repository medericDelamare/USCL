{% extends 'base.html.twig' %}
{% block body %}
<ol class="breadcrumb">
    <li><a href="index.php">Accueil</a></li>
    <li class="active">Club</li>
</ol>

<div class="container my-custom-container">
    <h1 class="page-header">Statistiques {{ categorie }} <small>1<sup>ère</sup> Division Groupe A</small></h1>
    <div class="row">
        <div class="col-sm-4 col-sm-offset-1">
            <h2 class="page-header">Classement</h2>
            <table class="resultats table table-condensed">
                <thead>
                <tr>
                    <td>Pl</td>
                    <td>Equipe</td>
                    <td>Pts</td>
                    <td>G</td>
                    <td>N</td>
                    <td>D</td>
                    <td>F</td>
                    <td>BP</td>
                    <td>BC</td>
                    <td>P</td>
                    <td>Diff</td>
                </tr>
                </thead>
                {% for detail in classement %}
                    <tr>
                        <td>{{ detail['place'] }}</td>
                        <td>{{ detail['equipe'] }}</td>
                        <td>{{ detail['points'] }}</td>
                        <td>{{ detail['gagnes'] }}</td>
                        <td>{{ detail['nuls'] }}</td>
                        <td>{{ detail['defaites'] }}</td>
                        <td>{{ detail['forfaits'] }}</td>
                        <td>{{ detail['butsPour'] }}</td>
                        <td>{{ detail['butsContre'] }}</td>
                        <td>{{ detail['penalites'] }}</td>
                        <td>{{ detail['differences'] }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>

        <div class="col-sm-4 col-sm-offset-2">
            <h2 class="page-header">Résutats du groupe</h2>
            <table class="resultats table table-condensed">
                {% for resultat in resultats %}
                    <tr>
                        <td colspan="3" class="tr-date text-center"><small><em>{{ resultat['date'] }}</em></small></td>
                        <td class="text-center">{{ resultat['equipe1'] }}</td>
                        <td class="text-center">{{ resultat['score'] }}</td>
                        <td class="text-center">{{ resultat['equipe2'] }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-4 col-sm-offset-1">
            <h2 class="page-header">Agenda</h2>
            <table class="agenda table table-condensed">
                {% for agenda in agendas%}
                    <tr>
                        <td colspan="3" class="tr-date text-center"><small><em>{{ agenda['date'] }}</em></small></td>
                        <td class="text-center">{{ agenda['equipe1'] }}</td>
                        <td class="text-center">{{ agenda['score'] }}</td>
                        <td class="text-center">{{ agenda['equipe2'] }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>
        <div class="col-sm-4 col-sm-offset-2">
            <h2 class="page-header">Calendrier</h2>
            <table class="calendrier table table-condensed">
                {% for calendrierInfos in calendrier %}
                    <tr>
                        <td colspan="3" class="tr-date text-center"><small><em>{{ calendrierInfos['date'] }}</em></small></td>
                        <td class="text-center">{{ calendrierInfos['equipe1'] }}</td>
                        <td class="text-center">{{ calendrierInfos['score'] }}</td>
                        <td class="text-center">{{ calendrierInfos['equipe2'] }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>
        <div class="row">
            <div class="col-sm-4 col-sm-offset-1">
                <h2 class="page-header">Évolution du classement final selon les années</h2>
                <canvas id="myChart"></canvas>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
    <script type="text/javascript">
        $(".classement td").each(function() {
            if($(this).html() == "Corm.Lieurey Us"){
                $(this).parent().addClass("info");
                $(this).parent().css("font-weight","bold");
            }
        });

        $(".resultats td").each(function() {
            if($(this).html() == "Corm.Lieurey Us"){
                $(this).parent().addClass("info");
                $(this).parent().css("font-weight","bold");
            }
        });

        $(".agenda td").each(function() {
            if($(this).html() == "Corm.Lieurey Us"){
                $(this).parent().addClass("info");
                $(this).parent().css("font-weight","bold");
            }
        });

        $(".calendrier > tbody > tr").each(function(){

            var string = $('.score > strong', this).html();
            if(string != null)
            {
                var res = string.split(" ");

                if (res[0] == res[2]) {
                    $(this).addClass('warning');
                };

                if ($('.text-left', this).html() == 'Corm.Lieurey Us' && res[0] > res[2]) {
                    $(this).addClass('success');
                };

                if ($('.text-left', this).html() == 'Corm.Lieurey Us' && res[0] < res[2]) {
                    $(this).addClass('danger');
                };

                if ($('.text-right', this).html() == 'Corm.Lieurey Us' && res[0] < res[2]) {
                    $(this).addClass('success');
                };

                if ($('.text-right', this).html() == 'Corm.Lieurey Us' && res[0] > res[2]) {
                    $(this).addClass('danger');
                };
            }

        });

        $( ".classement > tbody > tr:nth-child(2)" ).addClass("success");
        $( ".classement > tbody > tr:nth-child(3)" ).addClass("success");
        $( ".classement > tbody > tr:nth-child(13)" ).addClass("danger");
    </script>

    <script>
    var ctx = document.getElementById("myChart").getContext('2d');

    var positions = {{ positions|json_encode() }};
    var annees = {{ annees|json_encode|raw }};
    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: annees,
            datasets: [{
                data: positions,
                borderWidth: 2,
                backgroundColor: [],
                lineTension: 0.1,
                fill: false,
                borderColor: "rgb(58, 83, 155)"
            }]
        },
        options: {
            legend: {
                display: false
            },
            scales: {
                yAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: 'Position'
                    },
                    ticks: {
                        beginAtZero:true,
                        reverse: true,
                        min: 1,
                        max: 12
                    }
                }],
                xAxes: [{
                    scaleLabel: {
                        display: true,
                        labelString: 'Année'
                    }
                }]
            }
        }
    });
</script>
{% endblock %}